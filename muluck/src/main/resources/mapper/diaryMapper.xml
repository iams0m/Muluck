<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="diary">
	<!-- insert, delete, update는 무조건 resultType="int"이므로 프로그래머가 써주지 않아도 이미 resultType="int"가 있는 것으로 본다 -->
	
	<!-- diary.jsp에 받을 mapper -->
	<insert id="create" parameterType="diaryVO">
		insert into diary(d_img, d_title, d_contents, d_mood, d_date, member_no)
		values (#{d_img}, #{d_title}, #{d_contents}, #{d_mood}, sysdate(), #{member_no})
	</insert>

	<!-- diary_first에 받을 mapper -->
	<insert id="create2" parameterType="diaryVO">
		insert into diary(d_img, d_nickname, d_title, d_contents, d_mood, d_date, member_no)
		values (#{d_img}, #{d_nickname}, #{d_title}, #{d_contents}, #{d_mood}, sysdate(), #{member_no})
	</insert>
	
<!-- 	<delete id="del"  parameterType="String"> 
	parameterType에 String나 memberVO를 그대로 써도 상관없음. memberVO를 사용해도 VO 안에 이미 id를 String으로 받기 때문에 문제안됨.
		delete from kids 
		where no = #{no}
	</delete>
	
	<update id="up"  parameterType="kidsVO">
		update kids
		set tel = #{tel} 
		where no = #{no}
	</update>
	
	<select id="one" parameterType="kidsVO" resultType="kidsVO">
		select *
		from kids
		where no = #{no}
	</select> -->

	<!-- cardview_list에 받을 mapper -->
	<select id="list" resultType="diaryVO">
		select t1.d_no, t1.d_img, t1.d_nickname, t1.d_title, t1.d_date
		from diary t1
		inner join (
		select d_nickname, MAX(d_date) AS max_date
		from diary
		group by d_nickname
		) t2 on t1.d_nickname = t2.d_nickname AND t1.d_date = t2.max_date
		where t1.d_nickname in (
		select d_nickname
		from diary
		group by d_nickname)
	</select>
	
	
	<!-- cardview_individual에 받을 mapper -->
	<select id="list2" resultType="diaryVO" parameterType="diaryVO"> 
		select d_no, d_img, d_nickname, d_title, d_date
		from diary
		where d_nickname = #{d_nickname} and member_no = #{member_no}
	</select>
	
	<!-- vo와 db table이 같을 때는 자동으로 컬럼명과 동일한 vo의 변수에 자동으로 넣어줌. vo와 db table이 다를 때는 수동으로 어떤 컬럼명에서 꺼내서 vo의 변수에 넣어줄지
		 mapping을 해주어야 함.
		 
		 <resultMap type="memberVO" ID="map1">
		 	<result property="id" column="id"/>
		 </resultMap>
		  -->
	
</mapper>